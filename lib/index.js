var O=Object.defineProperty;var c=(a,e)=>{for(var t in e)O(a,t,{get:e[t],enumerable:!0})};var C={};c(C,{DEFAULT_CLIENT_OPTIONS:()=>u,DEFAULT_PUPPETEER_OPTIONS:()=>g,HIBP_REFERRER:()=>d,HIBP_URL:()=>m});var m="https://haveibeenpwned.com/",d="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",g={headless:!1,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},u={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};import B from"node:events";var x={};c(x,{EMAIL_BTN:()=>b,EMAIL_INPUT:()=>E,HOME_NAVBAR_LINK:()=>h,PASSWORD_INPUT:()=>P,PASSWORD_NAVBAR_LINK:()=>w,PWNED_BTN:()=>f,PWNED_EMAIL_RESULT:()=>y,PWNED_MESSAGE_CONTAINER:()=>A,PWNED_MESSAGE_RESULT:()=>v});var w='a[href="/Passwords"]',h='a[href="/Home"]',P='input[placeholder="password"]',E='input[placeholder="email address"]',f="#searchPwnedPasswords",b="#searchPwnage",A=".pwnTitle",v="#pwnedPasswordResult",y=".pwnTitle";var _={};c(_,{isElementInDom:()=>I});var I=async(a,e)=>{try{return await a?.evaluate(async r=>new Promise(i=>{if(document.querySelector(r)){i(!0);return}let p=new MutationObserver(()=>{document.querySelector(r)&&(p.disconnect(),i(!0))});p.observe(document,{childList:!0,subtree:!0}),setTimeout(()=>{p.disconnect(),i(!1)},5e3)}),e)||!1}catch{return!1}};var l=class{constructor(){this.navLink=w;this.pwInput=P;this.emailInput=E;this.pwnedBtn=f;this.searchPwnageBtn=b;this.messageContainer=A;this.messageEmailContainer=y;this.pwnedMessage=v;this.homeLink=h}async isEmailPwned(e,t){try{if(await e.type(this.emailInput,t,{delay:120}),await e.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await e.$eval(this.messageEmailContainer,s=>s.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async isPasswordPwned(e,t){try{if(await e.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await e.click(this.navLink),await this.waitFor(1e3,2e3),await e.type(this.pwInput,t,{delay:120}),await e.click(this.pwnedBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1e3,2e3),{isPasswordPwned:!0,message:await e.$eval(this.pwnedMessage,s=>s.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async waitFor(e,t){let r=(i,s)=>Math.floor(Math.random()*(s-i+1))+i;return new Promise(i=>setTimeout(()=>i(),r(e,t)))}async isConfirmationMessageInDom(e,t){try{return await I(e,t)}catch{return!1}}};import M from"puppeteer-extra";import N from"puppeteer-extra-plugin-stealth";import S from"user-agents";var T=class extends B{constructor(e,t={}){super(),this.puppeteerOptions={...g,...t},this.options={...u,...e},this.pwned=new l,this.userAgent=new S}when(e,t){this.on(e,t)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await M.use(N()).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client ready")}catch(e){throw this.emit("client crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await this.page?.goto(m,{waitUntil:"networkidle0",timeout:0,referer:d})}async waitFor(e,t,r){let i=(s,p)=>Math.floor(Math.random()*(p-s+1))+s;return new Promise(s=>setTimeout(()=>s(),i(t,r)))}onEvent(e,t){return this.on(e,(...r)=>{t(...r)})}};var R={};var L={};export{T as Ihbp,l as Pwned,L as clientTypes,C as common,R as puppeteerTypes,x as selectors,_ as utils};
//# sourceMappingURL=index.js.map