var C=Object.defineProperty;var B=(s,t,e)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var r=(s,t,e)=>B(s,typeof t!="symbol"?t+"":t,e);var g="https://haveibeenpwned.com/",h="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",w={headless:!1,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},u={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};import N from"node:events";var d='a[href="/Passwords"]',P='a[href="/Home"]',E='input[placeholder="password"]',A='input[placeholder="email address"]',v="#searchPwnedPasswords",f="#searchPwnage",I=".pwnTitle",y="#pwnedPasswordResult",b=".pwnTitle";var _=async(s,t)=>{try{return await s?.evaluate(async i=>new Promise(n=>{if(document.querySelector(i)){n(!0);return}let o=new MutationObserver(()=>{document.querySelector(i)&&(o.disconnect(),n(!0))});o.observe(document,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect(),n(!1)},5e3)}),t)||!1}catch{return!1}};var l=class{constructor(){r(this,"navLink",d);r(this,"pwInput",E);r(this,"emailInput",A);r(this,"pwnedBtn",v);r(this,"searchPwnageBtn",f);r(this,"messageContainer",I);r(this,"messageEmailContainer",b);r(this,"pwnedMessage",y);r(this,"homeLink",P)}async isEmailPwned(t,e){try{if(await t.type(this.emailInput,e,{delay:120}),await t.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(t,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await t.$eval(this.messageEmailContainer,a=>a.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async isPasswordPwned(t,e){try{if(await t.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await t.click(this.navLink),await this.waitFor(1e3,2e3),await t.type(this.pwInput,e,{delay:120}),await t.click(this.pwnedBtn),await this.isConfirmationMessageInDom(t,this.messageContainer))return await this.waitFor(1e3,2e3),{isPasswordPwned:!0,message:await t.$eval(this.pwnedMessage,a=>a.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async waitFor(t,e){let i=(n,a)=>Math.floor(Math.random()*(a-n+1))+n;return new Promise(n=>setTimeout(()=>n(),i(t,e)))}async isConfirmationMessageInDom(t,e){try{return await _(t,e)}catch{return!1}}};import O from"puppeteer-extra";import M from"puppeteer-extra-plugin-stealth";import R from"user-agents";var T=class extends N{constructor(e,i={}){super();r(this,"puppeteerOptions");r(this,"options");r(this,"page");r(this,"browser");r(this,"pwned");r(this,"userAgent");this.puppeteerOptions={...w,...i},this.options={...u,...e},this.pwned=new l,this.userAgent=new R}when(e,i){this.on(e,i)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await O.use(M()).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client ready")}catch(e){throw this.emit("client crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await this.page?.goto(g,{waitUntil:"networkidle0",timeout:0,referer:h})}async waitFor(e,i,n){let a=(o,c)=>Math.floor(Math.random()*(c-o+1))+o;return new Promise(o=>setTimeout(()=>o(),a(i,n)))}onEvent(e,i){return this.on(e,(...n)=>{i(...n)})}};export{u as DEFAULT_CLIENT_OPTIONS,w as DEFAULT_PUPPETEER_OPTIONS,f as EMAIL_BTN,A as EMAIL_INPUT,h as HIBP_REFERRER,g as HIBP_URL,P as HOME_NAVBAR_LINK,T as Ihbp,E as PASSWORD_INPUT,d as PASSWORD_NAVBAR_LINK,v as PWNED_BTN,b as PWNED_EMAIL_RESULT,I as PWNED_MESSAGE_CONTAINER,y as PWNED_MESSAGE_RESULT,l as Pwned};
//# sourceMappingURL=index.js.map