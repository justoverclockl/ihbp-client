var T=Object.defineProperty;var M=(n,t,e)=>t in n?T(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var C=(n,t)=>{for(var e in t)T(n,e,{get:t[e],enumerable:!0})};var r=(n,t,e)=>M(n,typeof t!="symbol"?t+"":t,e);var B={};C(B,{DEFAULT_CLIENT_OPTIONS:()=>w,DEFAULT_PUPPETEER_OPTIONS:()=>h,HIBP_REFERRER:()=>g,HIBP_URL:()=>c});var c="https://haveibeenpwned.com/",g="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",h={headless:!1,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},w={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};import R from"node:events";var N={};C(N,{EMAIL_BTN:()=>v,EMAIL_INPUT:()=>E,HOME_NAVBAR_LINK:()=>d,PASSWORD_INPUT:()=>P,PASSWORD_NAVBAR_LINK:()=>u,PWNED_BTN:()=>A,PWNED_EMAIL_RESULT:()=>y,PWNED_MESSAGE_CONTAINER:()=>f,PWNED_MESSAGE_RESULT:()=>I});var u='a[href="/Passwords"]',d='a[href="/Home"]',P='input[placeholder="password"]',E='input[placeholder="email address"]',A="#searchPwnedPasswords",v="#searchPwnage",f=".pwnTitle",I="#pwnedPasswordResult",y=".pwnTitle";var O=async(n,t)=>{try{return await n?.evaluate(async i=>new Promise(s=>{if(document.querySelector(i)){s(!0);return}let o=new MutationObserver(()=>{document.querySelector(i)&&(o.disconnect(),s(!0))});o.observe(document,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect(),s(!1)},5e3)}),t)||!1}catch{return!1}};var l=class{constructor(){r(this,"navLink",u);r(this,"pwInput",P);r(this,"emailInput",E);r(this,"pwnedBtn",A);r(this,"searchPwnageBtn",v);r(this,"messageContainer",f);r(this,"messageEmailContainer",y);r(this,"pwnedMessage",I);r(this,"homeLink",d)}async isEmailPwned(t,e){try{if(await t.type(this.emailInput,e,{delay:120}),await t.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(t,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await t.$eval(this.messageEmailContainer,a=>a.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async isPasswordPwned(t,e){try{if(await t.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await t.click(this.navLink),await this.waitFor(1e3,2e3),await t.type(this.pwInput,e,{delay:120}),await t.click(this.pwnedBtn),await this.isConfirmationMessageInDom(t,this.messageContainer))return await this.waitFor(1e3,2e3),{isPasswordPwned:!0,message:await t.$eval(this.pwnedMessage,a=>a.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async waitFor(t,e){let i=(s,a)=>Math.floor(Math.random()*(a-s+1))+s;return new Promise(s=>setTimeout(()=>s(),i(t,e)))}async isConfirmationMessageInDom(t,e){try{return await O(t,e)}catch{return!1}}};import S from"puppeteer-extra";import L from"puppeteer-extra-plugin-stealth";import x from"user-agents";var b=class extends R{constructor(e,i={}){super();r(this,"puppeteerOptions");r(this,"options");r(this,"page");r(this,"browser");r(this,"pwned");r(this,"userAgent");this.puppeteerOptions={...h,...i},this.options={...w,...e},this.pwned=new l,this.userAgent=new x}when(e,i){this.on(e,i)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await S.use(L()).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client ready")}catch(e){throw this.emit("client crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await this.page?.goto(c,{waitUntil:"networkidle0",timeout:0,referer:g})}async waitFor(e,i,s){let a=(o,_)=>Math.floor(Math.random()*(_-o+1))+o;return new Promise(o=>setTimeout(()=>o(),a(i,s)))}onEvent(e,i){return this.on(e,(...s)=>{i(...s)})}};export{b as Ihbp,l as Pwned,B as common,N as selectors};
//# sourceMappingURL=index.js.map