"use strict";var D=Object.create;var p=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var l=(s,e)=>{for(var t in e)p(s,t,{get:e[t],enumerable:!0})},R=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of U(e))!H.call(s,i)&&i!==t&&p(s,i,{get:()=>e[i],enumerable:!(r=k(e,i))||r.enumerable});return s};var d=(s,e,t)=>(t=s!=null?D(F(s)):{},R(e||!s||!s.__esModule?p(t,"default",{value:s,enumerable:!0}):t,s)),W=s=>R(p({},"__esModule",{value:!0}),s);var G={};l(G,{Ihbp:()=>m,Pwned:()=>o,clientTypes:()=>L,common:()=>P,puppeteerTypes:()=>N,selectors:()=>x,utils:()=>O});module.exports=W(G);var P={};l(P,{DEFAULT_CLIENT_OPTIONS:()=>w,DEFAULT_PUPPETEER_OPTIONS:()=>u,HIBP_REFERRER:()=>c,HIBP_URL:()=>g});var g="https://haveibeenpwned.com/",c="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",u={headless:!0,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},w={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};var C=d(require("events"),1);var x={};l(x,{EMAIL_BTN:()=>y,EMAIL_INPUT:()=>f,HOME_NAVBAR_LINK:()=>E,PASSWORD_INPUT:()=>v,PASSWORD_NAVBAR_LINK:()=>h,PWNED_BTN:()=>b,PWNED_EMAIL_RESULT:()=>T,PWNED_MESSAGE_CONTAINER:()=>A,PWNED_MESSAGE_RESULT:()=>I});var h='a[href="/Passwords"]',E='a[href="/Home"]',v='input[placeholder="password"]',f='input[placeholder="email address"]',b="#searchPwnedPasswords",y="#searchPwnage",A=".pwnTitle",I="#pwnedPasswordResult",T=".pwnTitle";var O={};l(O,{isElementInDom:()=>M});var M=async(s,e)=>{try{return await s?.evaluate(async r=>new Promise(i=>{if(document.querySelector(r)){i(!0);return}let a=new MutationObserver(()=>{document.querySelector(r)&&(a.disconnect(),i(!0))});a.observe(document,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect(),i(!1)},5e3)}),e)||!1}catch{return!1}};var o=class{constructor(){this.navLink=h;this.pwInput=v;this.emailInput=f;this.pwnedBtn=b;this.searchPwnageBtn=y;this.messageContainer=A;this.messageEmailContainer=T;this.pwnedMessage=I;this.homeLink=E}async isEmailPwned(e,t){try{if(await e.type(this.emailInput,t,{delay:120}),await e.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await e.$eval(this.messageEmailContainer,n=>n.textContent?.trim()||"")}}catch(r){return{message:"An error occurred",errorMessage:r instanceof Error?r.message:String(r)}}}async isPasswordPwned(e,t){try{if(await e.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await e.click(this.navLink),await this.waitFor(1e3,2e3),await e.type(this.pwInput,t,{delay:120}),await e.click(this.pwnedBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1500,2500),{isPasswordPwned:!0,message:await e.$eval(this.pwnedMessage,n=>n.textContent?.trim()||"")}}catch(r){return{message:"An error occurred",errorMessage:r instanceof Error?r.message:String(r)}}}async waitFor(e,t){let r=(i,n)=>Math.floor(Math.random()*(n-i+1))+i;return new Promise(i=>setTimeout(()=>i(),r(e,t)))}async isConfirmationMessageInDom(e,t){try{return await M(e,t)}catch{return!1}}};var B=d(require("puppeteer-extra"),1),_=d(require("puppeteer-extra-plugin-stealth"),1),S=d(require("user-agents"),1),m=class extends C.default{constructor(e,t={}){super(),this.puppeteerOptions={...u,...t},this.options={...w,...e},this.pwned=new o,this.userAgent=new S.default}when(e,t){this.on(e,t)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await B.default.use((0,_.default)()).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client_ready")}catch(e){throw this.emit("client_crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await this.page?.goto(g,{waitUntil:"networkidle0",timeout:0,referer:c})}async waitFor(e,t,r){let i=(n,a)=>Math.floor(Math.random()*(a-n+1))+n;return new Promise(n=>setTimeout(()=>n(),i(t,r)))}onEvent(e,t){return this.on(e,(...r)=>{t(...r)})}};var N={};var L={};0&&(module.exports={Ihbp,Pwned,clientTypes,common,puppeteerTypes,selectors,utils});
//# sourceMappingURL=index.cjs.map