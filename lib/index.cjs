"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _=Object.defineProperty;var l=(o,e)=>{for(var t in e)_(o,t,{get:e[t],enumerable:!0})};var T={};l(T,{DEFAULT_CLIENT_OPTIONS:()=>g,DEFAULT_PUPPETEER_OPTIONS:()=>d,HIBP_REFERRER:()=>m,HIBP_URL:()=>c});var c="https://haveibeenpwned.com/",m="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",d={headless:!1,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},g={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};var _events = require('events'); var _events2 = _interopRequireDefault(_events);var C={};l(C,{EMAIL_BTN:()=>f,EMAIL_INPUT:()=>P,HOME_NAVBAR_LINK:()=>w,PASSWORD_INPUT:()=>h,PASSWORD_NAVBAR_LINK:()=>u,PWNED_BTN:()=>E,PWNED_EMAIL_RESULT:()=>v,PWNED_MESSAGE_CONTAINER:()=>b,PWNED_MESSAGE_RESULT:()=>A});var u='a[href="/Passwords"]',w='a[href="/Home"]',h='input[placeholder="password"]',P='input[placeholder="email address"]',E="#searchPwnedPasswords",f="#searchPwnage",b=".pwnTitle",A="#pwnedPasswordResult",v=".pwnTitle";var x={};l(x,{isElementInDom:()=>y});var y=async(o,e)=>{try{return await _optionalChain([o, 'optionalAccess', _2 => _2.evaluate, 'call', _3 => _3(async r=>new Promise(i=>{if(document.querySelector(r)){i(!0);return}let a=new MutationObserver(()=>{document.querySelector(r)&&(a.disconnect(),i(!0))});a.observe(document,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect(),i(!1)},5e3)}),e)])||!1}catch (e2){return!1}};var p=class{constructor(){this.navLink=u;this.pwInput=h;this.emailInput=P;this.pwnedBtn=E;this.searchPwnageBtn=f;this.messageContainer=b;this.messageEmailContainer=v;this.pwnedMessage=A;this.homeLink=w}async isEmailPwned(e,t){try{if(await e.type(this.emailInput,t,{delay:120}),await e.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await e.$eval(this.messageEmailContainer,s=>_optionalChain([s, 'access', _4 => _4.textContent, 'optionalAccess', _5 => _5.trim, 'call', _6 => _6()])||"")}}catch (e3){return{message:"An error occurred"}}}async isPasswordPwned(e,t){try{if(await e.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await e.click(this.navLink),await this.waitFor(1e3,2e3),await e.type(this.pwInput,t,{delay:120}),await e.click(this.pwnedBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1e3,2e3),{isPasswordPwned:!0,message:await e.$eval(this.pwnedMessage,s=>_optionalChain([s, 'access', _7 => _7.textContent, 'optionalAccess', _8 => _8.trim, 'call', _9 => _9()])||"")}}catch (e4){return{message:"An error occurred"}}}async waitFor(e,t){let r=(i,s)=>Math.floor(Math.random()*(s-i+1))+i;return new Promise(i=>setTimeout(()=>i(),r(e,t)))}async isConfirmationMessageInDom(e,t){try{return await y(e,t)}catch (e5){return!1}}};var _puppeteerextra = require('puppeteer-extra'); var _puppeteerextra2 = _interopRequireDefault(_puppeteerextra);var _puppeteerextrapluginstealth = require('puppeteer-extra-plugin-stealth'); var _puppeteerextrapluginstealth2 = _interopRequireDefault(_puppeteerextrapluginstealth);var _useragents = require('user-agents'); var _useragents2 = _interopRequireDefault(_useragents);var I=class extends _events2.default{constructor(e,t={}){super(),this.puppeteerOptions={...d,...t},this.options={...g,...e},this.pwned=new p,this.userAgent=new _useragents2.default}when(e,t){this.on(e,t)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await _puppeteerextra2.default.use(_puppeteerextrapluginstealth2.default.call(void 0, )).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client ready")}catch(e){throw this.emit("client crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await _optionalChain([this, 'access', _10 => _10.page, 'optionalAccess', _11 => _11.goto, 'call', _12 => _12(c,{waitUntil:"networkidle0",timeout:0,referer:m})])}async waitFor(e,t,r){let i=(s,a)=>Math.floor(Math.random()*(a-s+1))+s;return new Promise(s=>setTimeout(()=>s(),i(t,r)))}onEvent(e,t){return this.on(e,(...r)=>{t(...r)})}};var S={};var R={};exports.Ihbp = I; exports.Pwned = p; exports.clientTypes = R; exports.common = T; exports.puppeteerTypes = S; exports.selectors = C; exports.utils = x;
//# sourceMappingURL=index.cjs.map