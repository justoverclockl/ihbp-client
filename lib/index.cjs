"use strict";var S=Object.create;var o=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(i,e)=>{for(var t in e)o(i,t,{get:e[t],enumerable:!0})},B=(i,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of D(e))!k.call(i,r)&&r!==t&&o(i,r,{get:()=>e[r],enumerable:!(s=x(e,r))||s.enumerable});return i};var p=(i,e,t)=>(t=i!=null?S(U(i)):{},B(e||!i||!i.__esModule?o(t,"default",{value:i,enumerable:!0}):t,i)),F=i=>B(o({},"__esModule",{value:!0}),i);var H={};g(H,{Ihbp:()=>h,Pwned:()=>a,common:()=>P,selectors:()=>T});module.exports=F(H);var P={};g(P,{DEFAULT_CLIENT_OPTIONS:()=>d,DEFAULT_PUPPETEER_OPTIONS:()=>c,HIBP_REFERRER:()=>l,HIBP_URL:()=>w});var w="https://haveibeenpwned.com/",l="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",c={headless:!1,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},d={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};var O=p(require("events"),1);var T={};g(T,{EMAIL_BTN:()=>f,EMAIL_INPUT:()=>v,HOME_NAVBAR_LINK:()=>A,PASSWORD_INPUT:()=>E,PASSWORD_NAVBAR_LINK:()=>u,PWNED_BTN:()=>I,PWNED_EMAIL_RESULT:()=>C,PWNED_MESSAGE_CONTAINER:()=>y,PWNED_MESSAGE_RESULT:()=>_});var u='a[href="/Passwords"]',A='a[href="/Home"]',E='input[placeholder="password"]',v='input[placeholder="email address"]',I="#searchPwnedPasswords",f="#searchPwnage",y=".pwnTitle",_="#pwnedPasswordResult",C=".pwnTitle";var N=require("@/utils/elementObserver"),a=class{constructor(){this.navLink=u;this.pwInput=E;this.emailInput=v;this.pwnedBtn=I;this.searchPwnageBtn=f;this.messageContainer=y;this.messageEmailContainer=C;this.pwnedMessage=_;this.homeLink=A}async isEmailPwned(e,t){try{if(await e.type(this.emailInput,t,{delay:120}),await e.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await e.$eval(this.messageEmailContainer,n=>n.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async isPasswordPwned(e,t){try{if(await e.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await e.click(this.navLink),await this.waitFor(1e3,2e3),await e.type(this.pwInput,t,{delay:120}),await e.click(this.pwnedBtn),await this.isConfirmationMessageInDom(e,this.messageContainer))return await this.waitFor(1e3,2e3),{isPasswordPwned:!0,message:await e.$eval(this.pwnedMessage,n=>n.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async waitFor(e,t){let s=(r,n)=>Math.floor(Math.random()*(n-r+1))+r;return new Promise(r=>setTimeout(()=>r(),s(e,t)))}async isConfirmationMessageInDom(e,t){try{return await(0,N.isElementInDom)(e,t)}catch{return!1}}};var R=p(require("puppeteer-extra"),1),M=p(require("puppeteer-extra-plugin-stealth"),1),b=p(require("user-agents"),1),h=class extends O.default{constructor(e,t={}){super(),this.puppeteerOptions={...c,...t},this.options={...d,...e},this.pwned=new a,this.userAgent=new b.default}when(e,t){this.on(e,t)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await R.default.use((0,M.default)()).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client ready")}catch(e){throw this.emit("client crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await this.page?.goto(w,{waitUntil:"networkidle0",timeout:0,referer:l})}async waitFor(e,t,s){let r=(n,L)=>Math.floor(Math.random()*(L-n+1))+n;return new Promise(n=>setTimeout(()=>n(),r(t,s)))}onEvent(e,t){return this.on(e,(...s)=>{t(...s)})}};0&&(module.exports={Ihbp,Pwned,common,selectors});
//# sourceMappingURL=index.cjs.map