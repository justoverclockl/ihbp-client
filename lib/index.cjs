"use strict";var S=Object.create;var p=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var D=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var k=(i,t,e)=>t in i?p(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var F=(i,t)=>{for(var e in t)p(i,e,{get:t[e],enumerable:!0})},C=(i,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of x(t))!U.call(i,n)&&n!==e&&p(i,n,{get:()=>t[n],enumerable:!(r=L(t,n))||r.enumerable});return i};var c=(i,t,e)=>(e=i!=null?S(D(i)):{},C(t||!i||!i.__esModule?p(e,"default",{value:i,enumerable:!0}):e,i)),H=i=>C(p({},"__esModule",{value:!0}),i);var s=(i,t,e)=>k(i,typeof t!="symbol"?t+"":t,e);var W={};F(W,{DEFAULT_CLIENT_OPTIONS:()=>u,DEFAULT_PUPPETEER_OPTIONS:()=>w,EMAIL_BTN:()=>f,EMAIL_INPUT:()=>A,HIBP_REFERRER:()=>h,HIBP_URL:()=>g,HOME_NAVBAR_LINK:()=>P,Ihbp:()=>_,PASSWORD_INPUT:()=>E,PASSWORD_NAVBAR_LINK:()=>d,PWNED_BTN:()=>v,PWNED_EMAIL_RESULT:()=>b,PWNED_MESSAGE_CONTAINER:()=>I,PWNED_MESSAGE_RESULT:()=>y,Pwned:()=>l});module.exports=H(W);var g="https://haveibeenpwned.com/",h="https://www.google.com/search?q=ihave+been+pwned&oq=ihave+been+pwned&gs_lcrp=EgZjaHJvbWUyBggAEEUYOTINCAEQLhiDARixAxiABDIHCAIQABiABDINCAMQLhjHARjRAxiABDIHCAQQLhiABDIJCAUQABgKGIAEMgcIBhAAGIAEMgcIBxAAGIAEMgcICBAAGIAE0gEIMzkwOWowajeoAgCwAgA&sourceid=chrome&ie=UTF-8",w={headless:!1,defaultViewport:null,args:["--no-sandbox","--disable-setuid-sandbox"]},u={authTimeoutMs:0,qrMaxRetries:0,takeoverOnConflict:!1,takeoverTimeoutMs:0,ffmpegPath:"ffmpeg",bypassCSP:!0,proxyAuthentication:void 0};var N=c(require("events"),1);var d='a[href="/Passwords"]',P='a[href="/Home"]',E='input[placeholder="password"]',A='input[placeholder="email address"]',v="#searchPwnedPasswords",f="#searchPwnage",I=".pwnTitle",y="#pwnedPasswordResult",b=".pwnTitle";var B=async(i,t)=>{try{return await i?.evaluate(async r=>new Promise(n=>{if(document.querySelector(r)){n(!0);return}let o=new MutationObserver(()=>{document.querySelector(r)&&(o.disconnect(),n(!0))});o.observe(document,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect(),n(!1)},5e3)}),t)||!1}catch{return!1}};var l=class{constructor(){s(this,"navLink",d);s(this,"pwInput",E);s(this,"emailInput",A);s(this,"pwnedBtn",v);s(this,"searchPwnageBtn",f);s(this,"messageContainer",I);s(this,"messageEmailContainer",b);s(this,"pwnedMessage",y);s(this,"homeLink",P)}async isEmailPwned(t,e){try{if(await t.type(this.emailInput,e,{delay:120}),await t.click(this.searchPwnageBtn),await this.isConfirmationMessageInDom(t,this.messageContainer))return await this.waitFor(1500,2500),{isEmailPwned:!0,message:await t.$eval(this.messageEmailContainer,a=>a.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async isPasswordPwned(t,e){try{if(await t.waitForSelector(this.navLink,{visible:!0,timeout:5e4}),await t.click(this.navLink),await this.waitFor(1e3,2e3),await t.type(this.pwInput,e,{delay:120}),await t.click(this.pwnedBtn),await this.isConfirmationMessageInDom(t,this.messageContainer))return await this.waitFor(1e3,2e3),{isPasswordPwned:!0,message:await t.$eval(this.pwnedMessage,a=>a.textContent?.trim()||"")}}catch{return{message:"An error occurred"}}}async waitFor(t,e){let r=(n,a)=>Math.floor(Math.random()*(a-n+1))+n;return new Promise(n=>setTimeout(()=>n(),r(t,e)))}async isConfirmationMessageInDom(t,e){try{return await B(t,e)}catch{return!1}}};var O=c(require("puppeteer-extra"),1),M=c(require("puppeteer-extra-plugin-stealth"),1),R=c(require("user-agents"),1);var _=class extends N.default{constructor(e,r={}){super();s(this,"puppeteerOptions");s(this,"options");s(this,"page");s(this,"browser");s(this,"pwned");s(this,"userAgent");this.puppeteerOptions={...w,...r},this.options={...u,...e},this.pwned=new l,this.userAgent=new R.default}when(e,r){this.on(e,r)}async init(){await this.initializeBrowser(),await this.configurePageOptions(),await this.navigateToHIBP()}async isPasswordPwned(e){return await this.pwned.isPasswordPwned(this.page,e)}async isEmailPwned(e){return await this.navigateToHIBP(),await this.pwned.isEmailPwned(this.page,e)}async initializeBrowser(){try{this.browser=await O.default.use((0,M.default)()).launch(this.puppeteerOptions);let e=await this.browser.pages();this.page=e.length>0?e[0]:await this.browser.newPage(),this.browser&&this.page&&this.emit("client ready")}catch(e){throw this.emit("client crashed"),e}}async configurePageOptions(){this.page&&(await this.page.setViewport({width:Math.floor(Math.random()*555)+1366,height:Math.floor(Math.random()*313)+768,deviceScaleFactor:1,isMobile:!1,hasTouch:!1,isLandscape:!1}),(this.options.userAgent!=null||this.options.userAgent===void 0)&&(console.log(this.userAgent.random().toString()),await this.page.setUserAgent(this.userAgent.random().toString())),this.options.proxyAuthentication&&await this.page.authenticate(this.options.proxyAuthentication),this.options.bypassCSP&&await this.page.setBypassCSP(this.options.bypassCSP),await this.page.evaluateOnNewDocument(()=>{window.Error=Error}))}async navigateToHIBP(){await this.page?.goto(g,{waitUntil:"networkidle0",timeout:0,referer:h})}async waitFor(e,r,n){let a=(o,T)=>Math.floor(Math.random()*(T-o+1))+o;return new Promise(o=>setTimeout(()=>o(),a(r,n)))}onEvent(e,r){return this.on(e,(...n)=>{r(...n)})}};0&&(module.exports={DEFAULT_CLIENT_OPTIONS,DEFAULT_PUPPETEER_OPTIONS,EMAIL_BTN,EMAIL_INPUT,HIBP_REFERRER,HIBP_URL,HOME_NAVBAR_LINK,Ihbp,PASSWORD_INPUT,PASSWORD_NAVBAR_LINK,PWNED_BTN,PWNED_EMAIL_RESULT,PWNED_MESSAGE_CONTAINER,PWNED_MESSAGE_RESULT,Pwned});
//# sourceMappingURL=index.cjs.map